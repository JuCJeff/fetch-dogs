import{D as E,a as v,b as w,j as e,r as l,u as j}from"./index-ClksnZDQ.js";import{u as y}from"./useAuth-CdJL3fLD.js";const O=async()=>{try{const s=await fetch(w,{method:"GET",credentials:"include"});if(!s.ok)throw new Error(`Fetch dog breeds failed: ${s.statusText}`);return await s.json()}catch(s){throw console.log("Fetch dog breeds failed: ",s),new Error("Unable to fetch dog breeds. Please try again")}},B=async({size:s=25,from:t=0,breeds:o=[],sort:c="breed:asc"})=>{console.log(o);const i=new URLSearchParams({size:s.toString(),from:t.toString(),sort:c});o.length!==0&&i.append("breeds",o.join(","));const r=`${E}?${i.toString()}`,n=await fetch(r,{method:"GET",credentials:"include"});if(!n.ok)throw new Error("Failed to fetch dogs");const d=await n.json();console.log(d);const h=await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d.resultIds),credentials:"include"});if(!h.ok)throw new Error("Failed to fetch dog details");return{dogs:await h.json(),total:d.total}},C=async s=>{const t=await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(!t.ok)throw new Error("Failed to fetch dog details");return await t.json()},T=()=>{const{logout:s}=y(),t=async()=>{try{await s()}catch(o){console.error("Logout failed:",o)}};return e.jsx("button",{onClick:t,children:"Logout"})},p=({dog:s,onFavoriteClick:t,isFavorite:o})=>e.jsxs("div",{className:"dog-card",children:[e.jsx("img",{src:s.img,alt:s.name,className:"dog-image"}),e.jsxs("div",{className:"dog-info",children:[e.jsx("h2",{children:s.name}),e.jsxs("p",{children:[e.jsx("strong",{children:"Breed:"})," ",s.breed]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age:"})," ",s.age," years"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ZIP ",s.zip_code]}),t&&e.jsx("button",{className:`favorite-btn ${o?"favorited":""}`,onClick:()=>t(s.id),children:o?"★ Favorited":"☆ Favorite"})]})]}),k=({activeTab:s,onTabChange:t})=>e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:s==="all"?"active":"",onClick:()=>t("all"),children:"All Dogs"}),e.jsx("button",{className:s==="favorites"?"active":"",onClick:()=>t("favorites"),children:"Favorite Dogs ❤️"})]}),A=({selectedBreed:s,onBreedSelect:t})=>{const[o,c]=l.useState([]);l.useEffect(()=>{(async()=>{const n=await O();c(n)})()},[]);const i=r=>{const n=r.target.value===""?"":r.target.value;t(n?[n]:[])};return e.jsxs("div",{className:"breed-filter",children:[e.jsx("label",{htmlFor:"breed-select",children:"Breed filter: "}),e.jsxs("select",{id:"breed-select",value:s,onChange:i,children:[e.jsx("option",{value:"",children:"All Breeds"},"all-breeds"),o.map(r=>e.jsx("option",{value:r,children:r},r))]})]})},I=[{param:"breed:asc",name:"Breed A-Z"},{param:"breed:desc",name:"Breed Z-A"},{param:"name:asc",name:"Name A-Z"},{param:"name:desc",name:"Name Z-A"},{param:"age:asc",name:"Youngest to Oldest"},{param:"age:desc",name:"Oldest to Youngest"}],L=({selectedSortOption:s,onSortOptionChange:t})=>e.jsxs("div",{className:"sort-options-container",children:[e.jsx("label",{htmlFor:"sort-options",children:"Sort Options: "}),e.jsx("select",{id:"sort-options",value:s,onChange:o=>t(o.target.value),children:I.map(({param:o,name:c})=>e.jsx("option",{value:o,children:c},o))})]}),R=({currentPage:s,totalPages:t,onPageChange:o})=>{const c=[1,2,3].filter(a=>a<=t),i=[t-2,t-1,t].filter(a=>a>3),r=3;let n=Math.max(4,s-Math.floor(r/2));const d=Math.min(t-3,n+r-1);d-n<r-1&&(n=Math.max(4,d-r+1));const h=[];for(let a=n;a<=d;a++)h.push(a);return e.jsxs("div",{className:"pagination",children:[e.jsx("button",{onClick:()=>o(s-1),disabled:s===1,children:"Previous"}),c.map(a=>e.jsx("button",{onClick:()=>o(a),className:a===s?"active":"",children:a},a)),n>4&&e.jsx("span",{children:"..."}),h.map(a=>e.jsx("button",{onClick:()=>o(a),className:a===s?"active":"",children:a},a)),d<t-3&&e.jsx("span",{children:"..."}),i.map(a=>e.jsx("button",{onClick:()=>o(a),className:a===s?"active":"",children:a},a)),e.jsx("button",{onClick:()=>o(s+1),disabled:s===t,children:"Next"})]})},_=25,G=({dogs:s,totalDogs:t,selectedBreeds:o,onBreedSelect:c,selectedSortOption:i,onSortOptionChange:r,currentPage:n,onPageChange:d})=>{const{favorites:h,toggleFavorite:a}=j();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"search-options",children:[e.jsx(A,{selectedBreed:o,onBreedSelect:c}),e.jsx(L,{selectedSortOption:i,onSortOptionChange:r}),e.jsx("button",{onClick:()=>c([]),children:"Reset Breed Filter"})]}),e.jsx("div",{className:"dog-list",children:s.map(u=>e.jsx(p,{dog:u,isFavorite:h.has(u.id),onFavoriteClick:a},u.id))}),e.jsx(R,{currentPage:n,totalPages:Math.ceil(t/_),onPageChange:d})]})},Z=({onFavoriteClick:s})=>{const{favorites:t}=j(),[o,c]=l.useState([]);return l.useEffect(()=>{(async()=>{if(t.size===0){c([]);return}try{const r=await C(Array.from(t));c(r)}catch(r){console.error("Failed to load favorite dogs:",r)}})()},[t]),e.jsxs("div",{children:[e.jsx("h2",{children:"Favorite Dogs"}),o.length===0?e.jsx("p",{children:"No favorites yet! ❤️"}):e.jsx("div",{className:"dog-list",children:o.map(i=>e.jsx(p,{dog:i,isFavorite:!0,onFavoriteClick:s},i.id))})]})},g=25,$=()=>{const[s,t]=l.useState("all"),[o,c]=l.useState([]),[i,r]=l.useState([]),[n,d]=l.useState("breed:asc"),[h,a]=l.useState(1),[u,S]=l.useState(0),[b,x]=l.useState(!0),[f,N]=l.useState(null),{toggleFavorite:D}=j();return l.useEffect(()=>{if(s==="favorites")return;(async()=>{x(!0);try{const{dogs:m,total:F}=await B({size:g,from:(h-1)*g,breeds:i||void 0,sort:n});console.log(m),c(m),S(F)}catch(m){N(`Failed to load dogs: ${m}`)}finally{x(!1)}})()},[h,s,i,n]),b?e.jsx("p",{children:"Loading..."}):f?e.jsx("p",{children:f}):e.jsxs("div",{children:[e.jsx("h1",{children:"Search for dogs"}),e.jsx(k,{activeTab:s,onTabChange:t}),s==="all"&&e.jsx(G,{dogs:o,totalDogs:u,selectedBreeds:i,onBreedSelect:r,selectedSortOption:n,onSortOptionChange:d,currentPage:h,onPageChange:a}),s==="favorites"&&e.jsx(Z,{onFavoriteClick:D}),e.jsx(T,{})]})};function J(){return e.jsx("div",{children:e.jsx($,{})})}export{J as default};
